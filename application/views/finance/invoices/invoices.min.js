/* Minified JS */
(function(a){a.invoices={init:function(){a("#invoice-add-members").click(function(c){c.preventDefault();ids="";a("#namelist").children().each(function(){id=a(this).attr("id");ids+=id+","});a("#ids").val(ids);a("#invoice-add-members-form").submit()});a("#invoice-add-member").click(function(){a.invoices.addToList()});a("#nameentry").keydown(function(c){if(c.keyCode==13){a.invoices.addToList()}});a(".invoice-mark-paid").click(function(e){e.preventDefault();var c=a(this);var d=c.siblings(".invoice-marked-status").text()=="1";a.ajax({type:"POST",url:script_url+"finance/invoices/mark_paid/",data:{id:c.siblings(".invoice-id").text(),new_status:(d?"0":"1")},error:function(){a.common.notify("The status of this invoice could not be changed.")},success:function(){b=c;var f=d?"0":"1";c.siblings(".invoice-marked-status").text(f);var g=d?"Mark As Paid":"Unmark As Paid";c.html(g);a("#astrix").text(d?"":"*")}})});a(".remove-member").click(function(d){d.preventDefault();var c=a("<div />").addClass("delete-conf-box");c.html("Are you sure you want to remove this member?<br />");button=a(this);console.log(button.closest("div"));c.dialog({resizable:false,draggable:false,modal:true,title:"Confirm Removal",buttons:{Remove:function(){a.ajax({type:"POST",url:script_url+"finance/invoices/remove_member/",data:{user:button.siblings(".member-id").html(),group:a("#group-id").html()},error:function(){a.common.notify("The member could not be removed")},success:function(){button.closest("div").remove()}});a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}}})});a(".set-privileges").click(function(d){d.preventDefault();var c=a("<div />").addClass("delete-conf-box");c.html("Are you sure you want to change this users permissions?<br />");button=a(this);c.dialog({resizable:false,draggable:false,modal:true,title:"Confirm Permissions",buttons:{Change:function(){a.ajax({type:"POST",url:script_url+"finance/invoices/change_permissions/",data:{user:button.siblings(".member-id").html(),group:a("#group-id").html(),new_status:button.siblings(".admin-check").hasClass("is-admin")==true?0:1},error:function(){a.common.notify("Unknown Error")},success:function(){if(button.siblings(".admin-check").hasClass("is-admin")){button.siblings(".admin-check").removeClass("is-admin");button.html("Make Admin")}else{button.siblings(".admin-check").addClass("is-admin");button.html("Remove Admin")}}});a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}}})});a("#new-group-owner").blur(function(){var c=a(this).val();id=-1;a("#fullnameslist").children().each(function(){if(a(this).html()==c){id=a(this).attr("id")}});a("#new-group-owner-id").val(id)});a(".remind-invoice").click(function(d){link=a(this).attr("href");d.preventDefault();var c=a("<div />").html("Are you sure you wish to remind all members? They get an email once a week anyway.<br />");c.dialog({resizable:false,draggable:false,modal:true,title:"Confirm Reminder",buttons:{Send:function(){a(this).dialog("close");window.location.href=link},Cancel:function(){a(this).dialog("close")}}})});a(".mark-unpaid").click(function(d){d.preventDefault();var c=a(this).parent();var e=c.attr("invoice-id");a.ajax({type:"POST",url:a(".ajax-url").html(),data:{mark_paid:0,method:"",id:e},error:function(){a.common.notify("Error...")},success:function(f){c.find(".mark-unpaid").hide();c.find(".mark-paid").show();c.prev().html("No");a(".search-people").select()}})});a(".search-people").click(function(){a(this).select()});a(".search-people").keyup(function(d){var c=a(".search-people").val();if(c===""){a(".name-search").parent().show()}else{a(".name-search").each(function(){if(a(this).html().toLowerCase().search(c.toLowerCase())>=0){a(this).parent().show()}else{a(this).parent().hide()}})}});a(".mark-paid").click(function(e){e.preventDefault();var g=a(this).attr("method");var d=a(this).html();var c=a(this).parent();var f=c.attr("invoice-id");a.ajax({type:"POST",url:a(".ajax-url").html(),data:{mark_paid:1,method:g,id:f},error:function(){a.common.notify("Error...")},success:function(h){c.find(".mark-paid").hide();c.find(".mark-unpaid").show();c.prev().html("Yes ("+d+")");a(".search-people").select()}})})},addToList:function(){var c=a("#nameentry").val();a("#nameentry").val("");var d=a("#nameentry-id").val();a("#nameentry-id").val("");a("#namelist").append('<option id="'+d+'">'+c+"</option>");a("#nameentry").focus()}}})(jQuery);