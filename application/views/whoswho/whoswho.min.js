/* Minified JS */
(function(a){a.whoswho={cache:[],mem_num:null,sorting:false,init:function(){a.whoswho.cache=[];a("a.whoswho-jsify").click(function(){if(!a.whoswho.sorting){a.whoswho.load_profile.call(this);history.pushState({},"",a(this).attr("href"))}return false});var b=a("#spinner").clone().attr("id","whoswho-spinner").hide();a("#whoswho-details").append(b);a.whoswho.sorting_init();a(".list-of-roles a").click(function(c){c.preventDefault();a(".role-description").html('<div class="spacer"></div>');a("<h2/>").html(a(this).children().html()).appendTo(".role-description");a(this).next().clone().appendTo(".role-description");a(".role-description h3").each(function(){a("<img/>").attr("src",a(this).attr("value")).insertAfter(this)});var e="Butler College JCR - Who's Who: "+a(this).children().html();history.pushState({},e,a(this).attr("href"));document.title=e;a("html, body").stop().animate({scrollTop:a(".content-right").offset().top})});a(".top-link").click(function(){event.preventDefault();a("html, body").stop().animate({scrollTop:0})});a(".report-link").click(function(c){c.preventDefault();a("<div></div>").dialog({modal:true,resizable:false,open:function(){a(this).html(a("#report-form").html())},buttons:{Submit:function(){text=a(this).children(".text-area").val();a.ajax({type:"POST",url:script_url+"whoswho/feedback",data:{text:text,page:a(".role-description").children("h2").first().html()}});a(this).html("Thank you for your help...");d=a(this);setTimeout(function(){d.parent().animate({opacity:0},{complete:function(){d.dialog("close");console.log("a")}})},500)}},width:"500px",title:"Anonymous Feedback"})});a("#whoswho").children().each(function(){a.whoswho.getDataUri(a(this))});a(".users-select").change(function(){if(a(this).is(":checked")){a(this).parent().parent().addClass("selected-user")}else{a(this).parent().parent().removeClass("selected-user")}});a(".select-all").click(function(c){c.preventDefault();a(".users-select").prop("checked",true);a(".user-icon").addClass("selected-user")});a(".select-none").click(function(c){c.preventDefault();a(".users-select").prop("checked",false);a(".selected-user").removeClass("selected-user")});a("#whoswho-print").click(function(f){f.preventDefault();var h="";var g=new jsPDF();var c={"#editor":function(j,k){return true}};i=1;a("#whoswho .selected-user").parent().each(function(){var k=a(this).find("p").eq(0).children().html();var l=a(this).find("p").eq(1).html();var j=a(this).find("p").eq(2).html();h=a(this).children("span").attr("data-uri");g.setFontType("bold");g.setFontSize(10);x=40+65*((i+1)%3);y=70+Math.ceil(i/3)*80-70;g.centerText(x,y,k);g.setFontType("normal");g.setFontSize(8);g.centerText(x,y+4,l);g.addImage(h,"JPEG",x-25,y-55,50,50);g.setDrawColor(200,0,0);g.rect(x-30,y-60,60,70);g.setFontType("italic");g.centerText(x,y+8,j);g.addImage(h,"JPEG",x-25,y-55,50,50);g.setDrawColor(200,0,0);g.rect(x-30,y-60,60,70);i++;if(i%10===0){g.addPage("a4","l");i=1}});d=new Date();var e="Whoswho - "+a(".page").html()+" - "+d.toDateString();g.save(e+".pdf")})},sorting_init:function(){var f=a("#whoswho");var b=a("#whoswho-order");var c='<span class="ui-icon ui-icon-gear inline-block"></span>';var e=f.find("li, li > a");f.sortable({disabled:true,placeholder:"whoswho-placeholder inline-block"}).disableSelection();b.click(function(){if(a.whoswho.sorting){e.css("cursor","auto");f.sortable("disable");b.html(c+"Saving...");a.whoswho.save_order(function(){b.html(c+"Saved.");setTimeout(function(){b.html(c+"Change Order")},2000)})}else{e.css("cursor","move");f.sortable("enable");b.html(c+"Save order")}a.whoswho.sorting=!a.whoswho.sorting;return false})},save_order:function(f){var e=a("#whoswho");var b=[];e.find("li").each(function(g,h){b.push({name:"order["+g+"]",value:a(h).find("div.whoswho-id").text()})});var c=a("#ww-nav").attr("value");a.post(script_url+"whoswho/save_order/"+c,b,f)},load_profile:function(){a.whoswho.mem_num=parseInt(this.href.substr(this.href.lastIndexOf("/")+1,this.href.length));if(a.whoswho.cache[a.whoswho.mem_num]){a("#whoswho-mem-content").html(a.whoswho.cache[a.whoswho.mem_num]).jsify();a.whoswho.scroll();return}a("#whoswho-spinner").show();a("#whoswho-mem-content").hide();a.ajax({type:"POST",url:this.href,data:{profile:1},success:a.whoswho.load,dataType:"json"})},load:function(b){if(b.redirect){window.location=b.redirect;return}a.whoswho.cache[a.whoswho.mem_num]=b.html;a("#whoswho-mem-content").html(b.html).jsify();a.common.preload_images(a("#whoswho-mem-content img"),a.whoswho.finish_loading)},scroll:function(){a("html,body").animate({scrollTop:a("#whoswho-icons").offset().top+a("#whoswho-icons").height()},{duration:"slow"})},finish_loading:function(){a.whoswho.scroll();a("#whoswho-spinner").hide();a("#whoswho-mem-content").show()},getDataUri:function(e){var b=e.find("div").css("background-image").substr(4);b=b.substring(1,b.length-2);var c=new Image();c.onload=function(){var f=document.createElement("canvas");f.width=this.naturalWidth;f.height=this.naturalHeight;f.getContext("2d").drawImage(this,0,0);e.children("span").attr("data-uri",f.toDataURL("image/jpeg"))};c.src=b}}})(jQuery);